{% extends 'base.html' %}
{% load static %}
{% load query_filters %}

{% block title %}Adopt - PawPal{% endblock %}
{% block extra_head %}
<style>
  .timeline-list {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 1rem;
  }

  .timeline-item {
    display: contents;
  }

  .timeline-circle {
    grid-column: 1;
    background-color: #d55e00;
    color: white;
    font-weight: bold;
    width: 32px;
    height: 32px;
    border-radius: 9999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Lexend', sans-serif;
    position: relative;
  }

  .timeline-content {
    grid-column: 2;
    padding-bottom: 1rem;
  }

  .timeline-circle::after {
    content: "";
    position: absolute;
    top: 32px;
    left: 50%;
    transform: translateX(-50%);
    height: calc(100% - 32px);
    width: 2px;
    background-color: #d55e00;
  }

  .timeline-item:last-child .timeline-circle::after {
    display: none;
  }

  .step-circle {
    background-color: #d55e00;
    color: white;
    font-weight: bold;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
    font-family: 'Lexend', sans-serif;
  }
</style>
{% endblock %}

{% block content %}

<div class="max-w-7xl mx-auto py-10 px-4">
  <h1 class="text-4xl font-bold text-center text-[#523a28] mb-10" style="font-family: 'Lexend', sans-serif;">Meet Your New Best Friend</h1>

  <!-- Layout: Sidebar + Content -->

  <div class="flex flex-col lg:flex-row gap-8 min-h-screen">
    <!-- Sidebar Filter -->
    <aside class="lg:w-1/4 bg-white rounded-lg shadow p-6 flex flex-col min-h-full">
    <form method="GET" id="filterForm" class="space-y-4">
      <!-- Search Box -->
      <input type="text" name="q" placeholder="Search by name, breed, color, ID..." value="{{ request.GET.q }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-300">
  
      <!-- Species -->
      <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Species</label>
        <select name="species" onchange="this.form.submit()" class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm">
            <option value="">All ({{ species_counts|get_item:'dog'|default:0|add:species_counts|get_item:'cat'|default:0 }})</option>
            <option value="dog" {% if species == 'dog' %}selected{% endif %}>
              Dog ({{ species_counts|get_item:'dog'|default:0 }})
            </option>
            <option value="cat" {% if species == 'cat' %}selected{% endif %}>
              Cat ({{ species_counts|get_item:'cat'|default:0 }})
            </option>
        </select>
      </div>

      <!-- Breed -->
      <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Breed</label>
        <input type="text" name="breed" value="{{ breed|default:'' }}" onchange="this.form.submit()" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
      </div>
  
      <!-- Size -->
      <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Size</label>
        <select name="size" onchange="this.form.submit()" class="w-full px-3 py-2 border rounded">
            <option value="">All</option>
            <option value="small" {% if size == 'small' %}selected{% endif %}>
              Small ({{ size_counts|get_item:'small'|default:0 }})
            </option>
            <option value="medium" {% if size == 'medium' %}selected{% endif %}>
              Medium ({{ size_counts|get_item:'medium'|default:0 }})
            </option>
            <option value="large" {% if size == 'large' %}selected{% endif %}>
              Large ({{ size_counts|get_item:'large'|default:0 }})
            </option>
            <option value="extra large" {% if size == 'extra large' %}selected{% endif %}>
              Extra Large ({{ size_counts|get_item:'extra large'|default:0 }})
            </option>
        </select>
      </div>

      <!-- Gender -->
      <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Gender</label>
        <select name="gender" onchange="this.form.submit()" class="w-full px-3 py-2 border rounded">
            <option value="">All</option>
            <option value="male" {% if gender == 'male' %}selected{% endif %}>
              Male ({{ gender_counts|get_item:'male'|default:0 }})
            </option>
            <option value="female" {% if gender == 'female' %}selected{% endif %}>
              Female ({{ gender_counts|get_item:'female'|default:0 }})
            </option>
        </select>
      </div>
  
      <!-- Color -->
      <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Color</label>
        <select name="color" onchange="this.form.submit()" class="w-full px-3 py-2 border rounded">
          <option value="">All</option>
      {% for c in color_choices %}
        <option value="{{ c }}" {% if color == c %}selected{% endif %}>
          {{ c }} ({{ color_counts|get_item:c|default:0 }})
        </option>
      {% endfor %}
        </select>
      </div>

       <!-- Age -->
       <div>
        <label class="block font-semibold text-sm text-[#6d4c41] mb-1">Age</label>
        <select name="age" onchange="this.form.submit()" class="w-full px-3 py-2 border rounded">
          <option value="">All</option>
          {% for age_option in age_choices %}
            <option value="{{ age_option|lower }}" {% if age == age_option|lower %}selected{% endif %}>
              {{ age_option }}
            </option>
          {% endfor %}
        </select>
      </div>
  
  
      <!-- Submit Button -->
      <button type="submit" class="w-full bg-[#d55e00] text-white font-semibold px-4 py-2 rounded-lg hover:bg-[#b54800] transition">Apply Filters</button>
    </form>
</aside>